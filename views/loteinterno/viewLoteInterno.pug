head
    title Lote Interno
    link(rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous")
    link(href="https://cdn.datatables.net/v/dt/dt-1.13.8/b-2.4.2/datatables.min.css" rel="stylesheet")
    link(href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer" rel="stylesheet")
    style.
        h2 {
            text-align: center;
            text-decoration: underline;
            text-underline-offset: 4px; /* Ajusta el espacio entre el texto y el subrayado */
        }
body
    div.container.my-4
      div.row
        div.col-sm-12.col-md-12.col-lg-12.col-xl-12
            section#viewLotesInternos
                h2 Listado de Lotes Internos
                br
                div(style="text-align: left;")
                    a.btn.btn-primary.btn-lg(href="/lotesinternos/crearLI") Crear
                    br
                    br
                    div.table.responsive
                        table#lotesinternos.table.table-striped.table-bordered
                            thead
                                tr
                                    th Número de Serie
                                    th Número de Lote
                                    th ID Laboratorio
                                    th Cantidad de Vacunas 
                                    th Fecha de LLegada Depósito Nacional 
                                    th ID Depósito Nacional 
                                    th Fecha de Salida Depósito Nacional 
                                    th Fecha de LLegada Depósito Provincial 
                                    th ID Depósito Provincial 
                                    th Fecha de Salida Depósito Provincial 
                                    th Fecha de Llegada Centro de Vacunación 
                                    th ID Centro de Vacunación
                                    th Opciones
            #mensajeModal.modal.fade(tabindex='-1' aria-labelledby='mensajeModalLabel' aria-hidden='true')
                .modal-dialog
                    .modal-content
                        .modal-header
                            h5#mensajeModalLabel.modal-title Mensaje
                            button(type='button' class='btn-close' data-bs-dismiss='modal' aria-label='Close')
                        .modal-body
                            p#mensajeTexto
  
                
            script(src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous")
            script(src='https://code.jquery.com/jquery-3.6.0.min.js')
            script(src="https://cdn.datatables.net/v/dt/dt-1.13.8/b-2.4.2/datatables.min.js")
// JavaScript para mostrar mensajes en el modal
script.
  function mostrarMensaje() {
    const successMessage = obtenerParametroURL('successMessage');
    const errorMessage = obtenerParametroURL('errorMessage');
    const mensajeModal = new bootstrap.Modal(document.getElementById('mensajeModal')); // Obtener el modal

    if (successMessage) {
      // Mostrar mensaje de éxito en el modal
      document.getElementById('mensajeTexto').innerText = successMessage;
      mensajeModal.show();
    } else if (errorMessage) {
      // Mostrar mensaje de error en el modal
      document.getElementById('mensajeTexto').innerText = errorMessage;
      mensajeModal.show();
    }
    console.log('El script se está ejecutando correctamente al cargar la página.');
  }

  window.onload = mostrarMensaje;

script.
    let loteint = !{JSON.stringify(lotesInternos)};
    let litab 
    $(document).ready(function() {
        litab = $('#lotesinternos').DataTable({
            data: loteint,
            pageLength:5,
            lengthMenu:[5,10,15,20],
            language: {
                url: '//cdn.datatables.net/plug-ins/1.13.7/i18n/es-AR.json'
            },
            columns:[
                {data: 'numeroDeSerie'},
                {data: 'numeroDeLote'},
                {data: 'idLaboratorio'},
                {data: 'cantidadDeVacunas'},
                {data: 'fechaDeLlegadaDepositoNacional'},
                {data: 'idDepositoNacional'},
                {data: 'fechaDeSalidaDepositoNacional'},
                {data: 'fechaDeLlegadaDepositoProvincial'},
                {data: 'idDepositoProvincial'},
                {data: 'fechaDeSalidaDepositoProvincial'},
                {data: 'fechaDeLlegadaCentroDeVacunacion'},
                {data: 'idCentroDeVacunacion'},

                {
                    data: null,
                    render: function(data, type, row) {
                        return `<button class="btn btn-success btn-sm fa-solid fa-pencil me-2"></button>` +
                            `<button class="btn btn-danger btn-sm fa-solid fa-trash-can"></button>`;
                    }
                }
            ],
            columnDefs: [
                //{orderable: false, targets:[12]}, // Columna de "Opciones"
                {searchable: false, targets:[1, 2, 3]},
                {className: "dt-center", targets: [2, 3, 5, 8, 11]},
                { width: "7%", targets: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11] },
                { width: "10%", targets: [12] }
            ]
        });
    });
    $(document).ready(function() {
        litab.on('click', 'button', function (f) {
            let data = litab.row(f.target.closest('tr')).data();
            if ($(event.target).hasClass('fa-trash-can')) {
                if(confirm("¿Desea eliminar el Lote Interno?")){
                    $.post('/lotesinternos/'+data.numeroDeSerie+'?_method=DELETE', function(data){
                         window.location.href = "/lotesinternos";
                    })
                }
            } else {window.location.href= "/lotesinternos/" + data.numeroDeSerie}
        })
    });
    function crearLI(){
        window.location.href= "/lotesinternos/crearLI"
    }